{% extends 'main.twig' %}
 {% block contenthead %}

     <div class="kt-subheader   kt-grid__item" id="kt_subheader">
         <div class="kt-subheader__main">
             <h3 class="kt-subheader__title">
                 Payments </h3>
             <span class="kt-subheader__separator kt-hidden"></span>
             <div class="kt-subheader__breadcrumbs">
                 <a href="#" class="kt-subheader__breadcrumbs-home"><i class="flaticon2-shelter"></i></a>
                 <span class="kt-subheader__breadcrumbs-separator"></span>
                 <a href="" class="kt-subheader__breadcrumbs-link">
                     Initiate Payment </a>
                 <span class="kt-subheader__breadcrumbs-separator"></span>
                 <a href="" class="kt-subheader__breadcrumbs-link">
                     Upload Via Excel</a>
             </div>
         </div>

     </div>
 {% endblock %}
{% block body %}
    <div class="row">
        <div class="col-lg-12">
            <!--begin::Portlet-->
            <div class="kt-portlet">
                <div class="kt-portlet__head">
                    <div class="kt-portlet__head-label">
                        <h3 class="kt-portlet__head-title">
                            Initiate Payment--Excel Upload
                        </h3>
                    </div>
                </div>
                <form class="kt-form">


                    <div class=" kt-portlet__body">


                        <div class="kt-section">
                            <div class="form-group">
                                <label>Product:</label>

                                <select  id="product" name="product" class="form-control">
                                    <option value="">Choose Product</option>
                                    {% for product in products %}

                                        <option value="{{ product.id }}"> {{ product.productName }} </option>
                                    {% endfor %}
                                </select>

                            </div>
                            <div class="form-group">
                                <label>Upload Excel:</label>
                                <input type="file" name="upload" id="upload" class="form-control" />
                            </div>
                        </div>
                    </div>
                    <div class="kt-portlet__foot">
                        <div class="kt-form__actions">
                            <div class="row">
                                <div class="col-lg-5"></div>
                                <div class="col-lg-7">
                                    <a href="{{ path_for('merchant.initiate-payment') }}" type="button" id="btn_cancel" class="btn btn-primary">Cancel</a>
                                    <button type="submit" id="btn_save" class="btn btn-success">Make Payment</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </form>


            </div>

            <!--end::Portlet-->
        </div>

    </div>
    <script type="text/javascript">
        $(document).ready(function() {

                    $('#btn_save').click(function () {

                        var worker_group = $('#worker_group').val();
                        var first_name = $('#first_name').val();
                        var last_name = $('#last_name').val();
                        var middle_name = $('#middle_name').val();
                        var id_number=$('#id_number').val();
                        var staff_id=$('#staff_id').val();


                        if (worker_group == '') {
                            toastr.error("Error Occured!!!", 'You must select a worker group');
                            return;
                        }

                        if (first_name == '') {
                            toastr.error("Error Occured!!!", 'Please Enter Your First Name');
                            return;
                        }

                        if (middle_name == '') {
                            toastr.error("Error Occured!!!", 'Please Enter Your Middle Name');
                            return;
                        }
                        if (last_name == '') {
                            toastr.error("Error Occured!!!", 'Please Enter Your Last Name');
                            return;
                        }
                        if (id_number == '') {
                            toastr.error("Error Occured!!!", 'You Must Enter Your ID Number');
                            return;
                        }
                        if (staff_id == '') {
                            toastr.error("Error Occured!!!", 'Set A Staff ID');
                            return;
                        }

                        $.ajax({
                            type: 'POST',
                            url: '{{ path_for('merchant.save-worker') }}',
                            data: {
                                worker_group: worker_group,
                                first_name: first_name,
                                last_name: last_name,
                                middle_name: middle_name,
                                id_number:id_number,
                                staff_id:staff_id
                            }
                        })
                            .success(function (data) {
                                window.setTimeout(function(){
                                    window.location.href='/worker/manage-workers';
                                }, 3000);
                            })
                            .fail(function (jqXHR, textStatus, errorThrown) {
                                alert(JSON.stringify(errorThrown));
                            });
                    });


        });
    </script>
{% endblock %}